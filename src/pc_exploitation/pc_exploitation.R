library(pcalg)

ctry_str <- "usa,rus,gbr,chn,isr,afg,irn,eur,pak,fra,pse,tur,jpn,irq,deu,can,aus,kor,prk"

exploita_pc <- function (fn)
{
    monpc <- read.csv(fn, header=TRUE, sep=",")
    suffStat <- list(C=cor(monpc),n=nrow(monpc))
    pc.fit <- pc(suffStat, indepTest=gaussCItest, p=ncol(monpc),alpha=0.005)
    as(pc.fit, "amat")
}

ctry <- strsplit(ctry_str, ",")


for(i in 1:length(ctry[[1]]))
{
   for(j in 1:2)
   {
      ind <- j-1
      tt <- exploita_pc(paste("exploitation_data/", ctry[[1]][i], "_", as.character(ind), "_1998_2007.csv", sep=""))  
       write(tt, file=paste("exploitation_pc/",ctry[[1]][i], "_", as.character(ind) ,sep=""), ncolumns = 18) 
    }
} 
